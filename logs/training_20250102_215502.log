2025-01-02 21:55:05 - INFO - Datos cargados desde ML/data/processed/BTCUSDT_15m_processed.csv, filas: 251947
2025-01-02 21:55:06 - INFO - Indicadores técnicos agregados al DataFrame. Filas antes: 251947, después: 251898
2025-01-02 21:55:06 - INFO - feature_columns.pkl actualizado con nuevas características.
2025-01-02 21:55:06 - INFO - Target binario mejorado con look_ahead=42, min_change=0.005, max_change=0.08
2025-01-02 21:55:06 - INFO - Distribución de clases (0/1):
target
0    161274
1     86803
Name: count, dtype: int64
2025-01-02 21:55:06 - INFO - División de datos en train y test completada.
2025-01-02 21:55:06 - INFO - === Buscando hiperparámetros (Optuna) en una muestra del training ===
2025-01-02 21:55:06 - INFO - Características cargadas desde: ML/data/processed/feature_columns.pkl
2025-01-02 21:55:06 - INFO - Cantidad de características antes de quitar problemáticas: 33
2025-01-02 21:55:06 - INFO - Cantidad de características después de quitar problemáticas: 33
2025-01-02 21:55:06 - INFO - Se eliminó 'close_time' de las características.
2025-01-02 21:55:06 - INFO - No se han identificado características categóricas.
2025-01-02 21:55:07 - INFO - Columnas eliminadas durante la preparación: ['close_time', 'future_close', 'change_pct']
2025-01-02 21:55:07 - INFO - Conjunto de datos preparado con 56437 filas y 32 características.
2025-01-02 21:55:07 - INFO - Tipo de y_train_sample: <class 'pandas.core.series.Series'>
2025-01-02 21:55:07 - INFO - Shape de y_train_sample: (56437,)
2025-01-02 21:55:07 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:55:07 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:55:08 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:55:08 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:55:09 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:55:10 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:55:11 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:55:13 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:55:13 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:55:15 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:55:15 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:55:16 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:55:17 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:55:18 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:55:18 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:55:19 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:55:20 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:55:21 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:55:22 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:55:23 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:55:24 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:55:26 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:55:28 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:55:29 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:55:32 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:55:33 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:55:33 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:55:35 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:55:37 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:55:38 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:55:38 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:55:40 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:55:41 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:55:43 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:55:44 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:55:46 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:55:47 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:55:48 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:55:49 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:55:50 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:55:51 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:55:52 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:55:53 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:55:55 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:55:56 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:55:58 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:55:58 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:56:00 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:56:01 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:56:01 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:56:03 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:56:04 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:56:06 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:56:11 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:56:12 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:56:15 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:56:16 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:56:17 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:56:17 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:56:18 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:56:19 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:56:20 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:56:21 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:56:23 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:56:24 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:56:25 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:56:26 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:56:27 - INFO - Después de SMOTE: target
0    4807
1    4807
Name: count, dtype: int64
2025-01-02 21:56:28 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:56:29 - INFO - Después de SMOTE: target
0    9846
1    9846
Name: count, dtype: int64
2025-01-02 21:56:31 - INFO - Después de SMOTE: target
0    15617
1    15617
Name: count, dtype: int64
2025-01-02 21:56:32 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:56:35 - INFO - Después de SMOTE: target
0    21776
1    21776
Name: count, dtype: int64
2025-01-02 21:56:36 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:56:39 - INFO - Después de SMOTE: target
0    28694
1    28694
Name: count, dtype: int64
2025-01-02 21:56:42 - INFO - Mejor valor de F1: 0.5087
2025-01-02 21:56:42 - INFO - Mejores parámetros: {'max_depth': 6, 'learning_rate': 0.0015630007201357903, 'n_estimators': 141, 'subsample': 0.8019566662470391, 'colsample_bytree': 0.8571235098895682, 'gamma': 0.30925944114494797, 'reg_alpha': 0.03825413629973503, 'reg_lambda': 0.02100031808056299}
2025-01-02 21:56:42 - INFO - === Entrenando Pipeline Final con TODO el training ===
2025-01-02 21:56:42 - INFO - Columnas eliminadas durante la preparación: ['close_time', 'future_close', 'change_pct']
2025-01-02 21:56:42 - INFO - Conjunto de datos preparado con 161250 filas y 32 características.
2025-01-02 21:56:42 - INFO - Tipo de y_train_full: <class 'pandas.core.series.Series'>
2025-01-02 21:56:42 - INFO - Shape de y_train_full: (161250,)
2025-01-02 21:56:49 - INFO - Después de SMOTE: target
0    100776
1    100776
Name: count, dtype: int64
2025-01-02 21:56:49 - INFO - Balance de clases aplicado mediante SMOTE.
2025-01-02 21:56:52 - INFO - Pipeline final entrenado con todos los datos de entrenamiento (binario).
2025-01-02 21:56:52 - INFO - Modelo guardado en: ./results/XGBoost_Binario_trained_pipeline.joblib
2025-01-02 21:56:52 - INFO - Parámetros guardados en: ./results/XGBoost_Binario_model_params.txt
2025-01-02 21:56:52 - INFO - Lista de features guardada en: ./results/XGBoost_Binario_feature_cols.txt
2025-01-02 21:56:52 - INFO - Indicadores técnicos agregados al DataFrame. Filas antes: 86827, después: 86778
2025-01-02 21:56:53 - INFO - Target binario mejorado con look_ahead=42, min_change=0.005, max_change=0.08
2025-01-02 21:56:53 - INFO - Distribución de clases (0/1):
target
0    60245
1    26170
Name: count, dtype: int64
2025-01-02 21:56:53 - INFO - Columnas eliminadas durante la preparación: ['close_time', 'future_close', 'change_pct']
2025-01-02 21:56:53 - INFO - Conjunto de datos preparado con 86415 filas y 32 características.
2025-01-02 21:56:53 - INFO - Características en X_test_final: ['open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'ignore', 'RSI_14', 'MACD_12_26_9', 'MACDh_12_26_9', 'MACDs_12_26_9', 'SMA_10', 'SMA_50', 'EMA_10', 'EMA_50', 'VWAP_D', 'OBV', 'BBL_20_2.0', 'BBM_20_2.0', 'BBU_20_2.0', 'BBB_20_2.0', 'BBP_20_2.0', 'ATRr_14', 'STOCHk_14_3_3', 'STOCHd_14_3_3', 'CCI_14_0.015', 'hour_of_day', 'day_of_week', 'is_weekend']
2025-01-02 21:56:53 - INFO - Tipo de y_test_final: <class 'pandas.core.series.Series'>
2025-01-02 21:56:53 - INFO - Shape de y_test_final: (86415,)
2025-01-02 21:56:53 - INFO - === Evaluación en Test ===
2025-01-02 21:56:53 - INFO - Matriz de confusión [1,0]:
[[12828 13342]
 [26387 33858]]
2025-01-02 21:56:53 - INFO - Reporte de Clasificación:
              precision    recall  f1-score   support

           1       0.33      0.49      0.39     26170
           0       0.72      0.56      0.63     60245

    accuracy                           0.54     86415
   macro avg       0.52      0.53      0.51     86415
weighted avg       0.60      0.54      0.56     86415

2025-01-02 21:56:53 - INFO - F1-score: 0.3924
2025-01-02 21:56:53 - INFO - Precisión: 0.3271
2025-01-02 21:56:53 - INFO - Recall: 0.4902
2025-01-02 21:56:53 - INFO - AUC Score: 0.5333
2025-01-02 21:56:56 - INFO - F1 final en Test (Binario): 0.3924
2025-01-02 21:56:56 - INFO - === Analizando importancia de características ===
2025-01-02 21:56:56 - INFO - Tabla de importancia de características guardada en ./results/feature_importances_binario.csv.
2025-01-02 21:56:56 - INFO - Gráfico de importancia de características guardado.
2025-01-02 21:56:56 - INFO - Características seleccionadas por importancia (> 0.02): ['is_weekend', 'BBB_20_2.0', 'day_of_week', 'hour_of_day', 'EMA_10', 'BBU_20_2.0', 'MACD_12_26_9', 'OBV', 'high', 'RSI_14', 'ATRr_14', 'close', 'STOCHd_14_3_3', 'low', 'BBM_20_2.0', 'EMA_50']
2025-01-02 21:56:56 - INFO - feature_columns.pkl actualizado con las características seleccionadas: ['is_weekend', 'BBB_20_2.0', 'day_of_week', 'hour_of_day', 'EMA_10', 'BBU_20_2.0', 'MACD_12_26_9', 'OBV', 'high', 'RSI_14', 'ATRr_14', 'close', 'STOCHd_14_3_3', 'low', 'BBM_20_2.0', 'EMA_50']
2025-01-02 21:56:57 - INFO - Columnas eliminadas durante la preparación: ['open', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'ignore', 'MACDh_12_26_9', 'MACDs_12_26_9', 'SMA_10', 'SMA_50', 'VWAP_D', 'BBL_20_2.0', 'BBP_20_2.0', 'STOCHk_14_3_3', 'CCI_14_0.015']
2025-01-02 21:56:57 - INFO - Conjunto de datos preparado con 161250 filas y 16 características.
2025-01-02 21:57:05 - INFO - Después de SMOTE: target
0    100776
1    100776
Name: count, dtype: int64
2025-01-02 21:57:05 - INFO - Balance de clases aplicado mediante SMOTE después de selección de características.
2025-01-02 21:57:08 - INFO - Pipeline final entrenado con todos los datos de entrenamiento (binario).
2025-01-02 21:57:08 - ERROR - Error en la ejecución principal: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- BBL_20_2.0
- BBP_20_2.0
- CCI_14_0.015
- MACDh_12_26_9
- MACDs_12_26_9
- ...

