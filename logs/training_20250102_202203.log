2025-01-02 20:22:06 - INFO - Datos cargados desde ML/data/processed/BTCUSDT_15m_processed.csv, filas: 251947
2025-01-02 20:22:06 - INFO - Indicadores técnicos agregados al DataFrame. Filas antes: 251947, después: 251898
2025-01-02 20:22:06 - INFO - feature_columns.pkl actualizado con nuevas características.
2025-01-02 20:22:07 - INFO - Target binario mejorado con look_ahead=14, min_change=0.007, max_change=0.09
2025-01-02 20:22:07 - INFO - Distribución de clases (0/1):
target
0    201604
1     49775
Name: count, dtype: int64
2025-01-02 20:22:07 - INFO - División de datos en train y test completada.
2025-01-02 20:22:07 - INFO - === Buscando hiperparámetros (Optuna) en una muestra del training ===
2025-01-02 20:22:07 - INFO - Características cargadas desde: ML/data/processed/feature_columns.pkl
2025-01-02 20:22:07 - INFO - Cantidad de características antes de quitar problemáticas: 30
2025-01-02 20:22:07 - INFO - Cantidad de características después de quitar problemáticas: 30
2025-01-02 20:22:07 - INFO - No se han identificado características categóricas.
2025-01-02 20:22:07 - INFO - Tipo de y_train_sample: <class 'pandas.core.series.Series'>
2025-01-02 20:22:07 - INFO - Shape de y_train_sample: (44242,)
2025-01-02 20:22:07 - INFO - Después de undersampling: target
0    2502
1    2502
Name: count, dtype: int64
2025-01-02 20:22:07 - INFO - Después de undersampling: target
0    2502
1    2502
Name: count, dtype: int64
2025-01-02 20:22:07 - INFO - Después de undersampling: target
0    5512
1    5512
Name: count, dtype: int64
2025-01-02 20:22:07 - INFO - Después de undersampling: target
0    8022
1    8022
Name: count, dtype: int64
2025-01-02 20:22:08 - INFO - Después de undersampling: target
0    9523
1    9523
Name: count, dtype: int64
2025-01-02 20:22:08 - INFO - Después de undersampling: target
0    10768
1    10768
Name: count, dtype: int64
2025-01-02 20:22:09 - INFO - Después de undersampling: target
0    2502
1    2502
Name: count, dtype: int64
2025-01-02 20:22:09 - INFO - Después de undersampling: target
0    5512
1    5512
Name: count, dtype: int64
2025-01-02 20:22:10 - INFO - Después de undersampling: target
0    5512
1    5512
Name: count, dtype: int64
2025-01-02 20:22:11 - INFO - Después de undersampling: target
0    8022
1    8022
Name: count, dtype: int64
2025-01-02 20:22:11 - INFO - Después de undersampling: target
0    8022
1    8022
Name: count, dtype: int64
2025-01-02 20:22:12 - INFO - Después de undersampling: target
0    9523
1    9523
Name: count, dtype: int64
2025-01-02 20:22:13 - INFO - Después de undersampling: target
0    9523
1    9523
Name: count, dtype: int64
2025-01-02 20:22:14 - INFO - Después de undersampling: target
0    10768
1    10768
Name: count, dtype: int64
2025-01-02 20:22:15 - INFO - Después de undersampling: target
0    10768
1    10768
Name: count, dtype: int64
2025-01-02 20:22:15 - INFO - Después de undersampling: target
0    2502
1    2502
Name: count, dtype: int64
2025-01-02 20:22:16 - INFO - Después de undersampling: target
0    5512
1    5512
Name: count, dtype: int64
2025-01-02 20:22:17 - INFO - Después de undersampling: target
0    8022
1    8022
Name: count, dtype: int64
2025-01-02 20:22:18 - INFO - Después de undersampling: target
0    2502
1    2502
Name: count, dtype: int64
2025-01-02 20:22:18 - INFO - Después de undersampling: target
0    9523
1    9523
Name: count, dtype: int64
2025-01-02 20:22:19 - INFO - Después de undersampling: target
0    5512
1    5512
Name: count, dtype: int64
2025-01-02 20:22:20 - INFO - Después de undersampling: target
0    10768
1    10768
Name: count, dtype: int64
2025-01-02 20:22:21 - INFO - Después de undersampling: target
0    8022
1    8022
Name: count, dtype: int64
2025-01-02 20:22:21 - INFO - Después de undersampling: target
0    2502
1    2502
Name: count, dtype: int64
2025-01-02 20:22:21 - INFO - Después de undersampling: target
0    5512
1    5512
Name: count, dtype: int64
2025-01-02 20:22:22 - INFO - Después de undersampling: target
0    8022
1    8022
Name: count, dtype: int64
2025-01-02 20:22:23 - INFO - Después de undersampling: target
0    9523
1    9523
Name: count, dtype: int64
2025-01-02 20:22:23 - INFO - Después de undersampling: target
0    9523
1    9523
Name: count, dtype: int64
2025-01-02 20:22:24 - INFO - Después de undersampling: target
0    10768
1    10768
Name: count, dtype: int64
2025-01-02 20:22:24 - INFO - Después de undersampling: target
0    2502
1    2502
Name: count, dtype: int64
2025-01-02 20:22:25 - INFO - Después de undersampling: target
0    10768
1    10768
Name: count, dtype: int64
2025-01-02 20:22:26 - INFO - Después de undersampling: target
0    5512
1    5512
Name: count, dtype: int64
2025-01-02 20:22:27 - INFO - Después de undersampling: target
0    2502
1    2502
Name: count, dtype: int64
2025-01-02 20:22:27 - INFO - Después de undersampling: target
0    8022
1    8022
Name: count, dtype: int64
2025-01-02 20:22:28 - INFO - Después de undersampling: target
0    5512
1    5512
Name: count, dtype: int64
2025-01-02 20:22:29 - INFO - Después de undersampling: target
0    9523
1    9523
Name: count, dtype: int64
2025-01-02 20:22:30 - INFO - Después de undersampling: target
0    8022
1    8022
Name: count, dtype: int64
2025-01-02 20:22:31 - INFO - Después de undersampling: target
0    10768
1    10768
Name: count, dtype: int64
2025-01-02 20:22:32 - INFO - Después de undersampling: target
0    9523
1    9523
Name: count, dtype: int64
2025-01-02 20:22:33 - INFO - Después de undersampling: target
0    2502
1    2502
Name: count, dtype: int64
2025-01-02 20:22:34 - INFO - Después de undersampling: target
0    10768
1    10768
Name: count, dtype: int64
2025-01-02 20:22:36 - INFO - Después de undersampling: target
0    2502
1    2502
Name: count, dtype: int64
2025-01-02 20:22:37 - INFO - Después de undersampling: target
0    5512
1    5512
Name: count, dtype: int64
2025-01-02 20:22:37 - INFO - Después de undersampling: target
0    5512
1    5512
Name: count, dtype: int64
2025-01-02 20:22:38 - INFO - Después de undersampling: target
0    8022
1    8022
Name: count, dtype: int64
2025-01-02 20:22:40 - INFO - Después de undersampling: target
0    9523
1    9523
Name: count, dtype: int64
2025-01-02 20:22:42 - INFO - Después de undersampling: target
0    10768
1    10768
Name: count, dtype: int64
2025-01-02 20:22:43 - INFO - Después de undersampling: target
0    8022
1    8022
Name: count, dtype: int64
2025-01-02 20:23:01 - INFO - Después de undersampling: target
0    2502
1    2502
Name: count, dtype: int64
2025-01-02 20:23:05 - INFO - Después de undersampling: target
0    5512
1    5512
Name: count, dtype: int64
2025-01-02 20:23:08 - INFO - Después de undersampling: target
0    9523
1    9523
Name: count, dtype: int64
2025-01-02 20:23:08 - INFO - Después de undersampling: target
0    8022
1    8022
Name: count, dtype: int64
2025-01-02 20:23:11 - INFO - Después de undersampling: target
0    9523
1    9523
Name: count, dtype: int64
2025-01-02 20:23:14 - INFO - Después de undersampling: target
0    10768
1    10768
Name: count, dtype: int64
2025-01-02 20:23:16 - INFO - Después de undersampling: target
0    10768
1    10768
Name: count, dtype: int64
2025-01-02 20:23:17 - INFO - Después de undersampling: target
0    2502
1    2502
Name: count, dtype: int64
2025-01-02 20:23:22 - INFO - Después de undersampling: target
0    5512
1    5512
Name: count, dtype: int64
2025-01-02 20:23:29 - INFO - Después de undersampling: target
0    8022
1    8022
Name: count, dtype: int64
2025-01-02 20:23:34 - INFO - Después de undersampling: target
0    9523
1    9523
Name: count, dtype: int64
2025-01-02 20:23:38 - INFO - Después de undersampling: target
0    10768
1    10768
Name: count, dtype: int64
2025-01-02 20:23:43 - INFO - Mejor valor de F1: 0.3761
2025-01-02 20:23:43 - INFO - Mejores parámetros: {'max_depth': 6, 'learning_rate': 0.004883569968234212, 'n_estimators': 50, 'subsample': 0.8590882677843868, 'colsample_bytree': 0.8964576170542601, 'gamma': 0.2691526316743105, 'reg_alpha': 0.0010966639954553509, 'reg_lambda': 0.02200353818086069}
2025-01-02 20:23:43 - INFO - === Entrenando Pipeline Final con TODO el training ===
2025-01-02 20:23:43 - INFO - Tipo de y_train_full: <class 'pandas.core.series.Series'>
2025-01-02 20:23:43 - INFO - Shape de y_train_full: (201103,)
2025-01-02 20:23:43 - INFO - Después de undersampling: target
0    42696
1    42696
Name: count, dtype: int64
2025-01-02 20:23:43 - INFO - Balance de clases aplicado mediante undersampling.
2025-01-02 20:23:44 - INFO - Pipeline final entrenado con todos los datos de entrenamiento (binario).
2025-01-02 20:23:44 - INFO - Modelo guardado en: ./results/XGBoost_Binario_trained_pipeline.joblib
2025-01-02 20:23:44 - INFO - Parámetros guardados en: ./results/XGBoost_Binario_model_params.txt
2025-01-02 20:23:44 - INFO - Lista de features guardada en: ./results/XGBoost_Binario_feature_cols.txt
2025-01-02 20:23:45 - INFO - Indicadores técnicos agregados al DataFrame. Filas antes: 50276, después: 50227
2025-01-02 20:23:45 - INFO - Target binario mejorado con look_ahead=14, min_change=0.007, max_change=0.09
2025-01-02 20:23:45 - INFO - Distribución de clases (0/1):
target
0    43134
1     7077
Name: count, dtype: int64
2025-01-02 20:23:45 - INFO - Tipo de y_test_final: <class 'pandas.core.series.Series'>
2025-01-02 20:23:45 - INFO - Shape de y_test_final: (50211,)
2025-01-02 20:23:45 - INFO - === Evaluación en Test ===
2025-01-02 20:23:45 - INFO - Matriz de confusión [1,0]:
[[ 7077     0]
 [43134     0]]
2025-01-02 20:23:45 - INFO - Reporte de Clasificación:
              precision    recall  f1-score   support

           1       0.14      1.00      0.25      7077
           0       0.00      0.00      0.00     43134

    accuracy                           0.14     50211
   macro avg       0.07      0.50      0.12     50211
weighted avg       0.02      0.14      0.03     50211

2025-01-02 20:23:45 - INFO - F1-score: 0.2471
2025-01-02 20:23:45 - INFO - Precisión: 0.1409
2025-01-02 20:23:45 - INFO - Recall: 1.0000
2025-01-02 20:23:45 - INFO - AUC Score: 0.5724
2025-01-02 20:23:48 - INFO - F1 final en Test (Binario): 0.2471
2025-01-02 20:23:48 - INFO - === Analizando importancia de características ===
2025-01-02 20:23:48 - INFO - Tabla de importancia de características guardada en ./results/feature_importances_binario.csv.
2025-01-02 20:23:48 - INFO - Gráfico de importancia de características guardado.
2025-01-02 20:23:48 - INFO - Características seleccionadas por importancia (> 0.02): ['close_time', 'number_of_trades', 'SMA_10', 'BBM_20_2.0']
2025-01-02 20:23:48 - INFO - Después de undersampling: target
0    42696
1    42696
Name: count, dtype: int64
2025-01-02 20:23:48 - INFO - Balance de clases aplicado mediante undersampling después de selección de características.
2025-01-02 20:23:48 - INFO - Pipeline final entrenado con todos los datos de entrenamiento (binario).
2025-01-02 20:23:48 - ERROR - Error en la ejecución principal: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- ATRr_14
- BBB_20_2.0
- BBL_20_2.0
- BBP_20_2.0
- BBU_20_2.0
- ...

